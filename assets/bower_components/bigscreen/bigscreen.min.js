// BigScreen v1.0.2 - 2013-01-20 - Apache 2.0 License
(function(e,n,t){"use strict";function r(e,n,t){var r;return function(){var l=this,u=arguments,i=function(){r=null,t||e.apply(l,u)},c=t&&!r;clearTimeout(r),r=setTimeout(i,n),c&&e.apply(l,u)}}function l(e){var n=null;if("VIDEO"===e.tagName)n=e;else{var t=e.getElementsByTagName("video");t[0]&&(n=t[0])}return n}function u(e){var n=l(e);if(n&&n.webkitEnterFullscreen)try{n.addEventListener("webkitbeginfullscreen",function t(){n.removeEventListener("webkitbeginfullscreen",t,!1),b(n)},!1),n.addEventListener("webkitendfullscreen",function r(){n.removeEventListener("webkitendfullscreen",r,!1),m(n)},!1),n.readyState<n.HAVE_METADATA?(n.addEventListener("loadedmetadata",function u(){n.removeEventListener("loadedmetadata",u,!1),n.webkitEnterFullscreen(),d=!!n.getAttribute("controls")},!1),n.load()):(n.webkitEnterFullscreen(),d=!!n.getAttribute("controls")),f=n,n.play()}catch(i){E.onerror.call(n)}else E.onerror.call(e)}function i(){E.element||(m(),o())}function c(){t&&"webkitfullscreenchange"===s.change&&e.addEventListener("resize",i,!1)}function o(){t&&"webkitfullscreenchange"===s.change&&e.removeEventListener("resize",i,!1)}var a="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,s=function(){for(var e=[{request:"requestFullscreen",exit:"exitFullscreen",enabled:"fullscreenEnabled",element:"fullscreenElement",change:"fullscreenchange",error:"fullscreenerror"},{request:"webkitRequestFullscreen",exit:"webkitExitFullscreen",enabled:"webkitFullscreenEnabled",element:"webkitFullscreenElement",change:"webkitfullscreenchange",error:"webkitfullscreenerror"},{request:"webkitRequestFullScreen",exit:"webkitCancelFullScreen",element:"webkitCurrentFullScreenElement",change:"webkitfullscreenchange",error:"webkitfullscreenerror"},{request:"mozRequestFullScreen",exit:"mozCancelFullScreen",enabled:"mozFullScreenEnabled",element:"mozFullScreenElement",change:"mozfullscreenchange",error:"mozfullscreenerror"}],t=!1,r=n.createElement("video"),l=0;e.length>l;l++)if(e[l].request in r){t=e[l];for(var u in t)"on"+t[u]in n||t[u]in n||t[u]in r||delete t[u];break}return r=null,t}(),f=null,d=null,b=r(function(){E.onenter.call(E)},500,!0),m=r(function(){f&&!d&&(f.setAttribute("controls","controls"),f.removeAttribute("controls")),f=null,d=null,E.onexit.call(E)},500,!0),E={request:function(e){if(e=e||n.documentElement,void 0===s.request)return u(e);if(t&&n[s.enabled]===!1)return u(e);if(t&&void 0===s.enabled)return s.enabled="webkitFullscreenEnabled",e[s.request](),setTimeout(function(){n[s.element]?n[s.enabled]=!0:(n[s.enabled]=!1,u(e))},250),void 0;try{e[s.request](a&&Element.ALLOW_KEYBOARD_INPUT),n[s.element]||e[s.request]()}catch(r){E.onerror.call(e)}},exit:function(){o(),n[s.exit]()},toggle:function(e){E.element?E.exit():E.request(e)},videoEnabled:function(e){if(E.enabled)return!0;var n=l(e);return n&&void 0!==n.webkitSupportsFullscreen?n.readyState<n.HAVE_METADATA?"maybe":n.webkitSupportsFullscreen:!1},onenter:function(){},onexit:function(){},onerror:function(){}};try{Object.defineProperties(E,{element:{enumerable:!0,get:function(){return f&&f.webkitDisplayingFullscreen?f:n[s.element]||null}},enabled:{enumerable:!0,get:function(){return"webkitCancelFullScreen"!==s.exit||t?n[s.enabled]||!1:!0}}})}catch(v){E.element=null,E.enabled=!1}s.change&&n.addEventListener(s.change,function(){E.element?(b(),c()):m()},!1),s.error&&n.addEventListener(s.error,function(e){E.onerror.call(e.target)},!1),e.BigScreen=E})(window,document,self!==top);